\thistype{ModulopUnivariateGcd}
\History{Manuel Bronstein}{24/7/98}{created}
\Usage{import from \this}
\Descr{\this~provides an implementation of an inplace gcd for polynomials
modulo a machine prime.}
\begin{exports}
\asexp{gcd!}: & (ARR Z, Z, ARR Z, Z, Z, Z) $\to$ (ARR Z, Z, Z) & in-place gcd\\
\end{exports}
\begin{aswhere}
Z &==& \astype{MachineInteger}\\
ARR &==& \astype{PrimitiveArray}\\
\end{aswhere}
\aspage{gcd!}
\Usage{\name(a, n, b, m, $\alpha$, p)\\
\name(a, n, b, m, $\alpha$, p, $[l_1,\dots,l_{p-1}], [e_1,\dots,e_{p-1}]$)}
\Signatures{
\name: (ARR Z, Z, ARR Z, Z, Z) $\to$ (ARR Z, Z, Z)\\
\name: (ARR Z, Z, ARR Z, Z, Z, ARR Z, ARR Z) $\to$ (ARR Z, Z, Z)\\
}
\begin{aswhere}
Z &==& \astype{MachineInteger}\\
ARR &==& \astype{Array}\\
\end{aswhere}
\Params{
{\em a,b} & \astype{PrimitiveArray} \astype{MachineInteger} &
polynomials modulo p\\
{\em n,m} & \astype{MachineInteger} & their degrees\\
$\alpha$ & \astype{MachineInteger} & a leading coefficient\\
{\em p} & \astype{MachineInteger} & a prime\\
$[l_0,\dots,l_{p-1}]$ & \astype{PrimitiveArray} \astype{MachineInteger} &
log table\\
$[e_0,\dots,e_{p-1}]$ & \astype{PrimitiveArray} \astype{MachineInteger} &
exp table\\
}
\Descr{
Given 2 polynomials stored in $a$ and $b$ of degrees $n$ and $m$ respectively,
computes a $\gcd(a,b)$ in $F_p[x]$ with leading coefficient $\alpha$.
Requires $n \ge m$ and that the polynomials are stored leading coefficient
first. Returns the degree of the gcd and its starting index in the array.
}
\Remarks{
The result can be stored in either $a$ or $b$, so the function also returns
the appropriate array. Note that both $a$ and $b$ are destroyed.
The last 2 optional arrays are such that $g^{l_i} = i$ and $e_i = g^i$
where $g$ is a primitive root for the multiplicative group modulo $p$.
They are used for fast multiplication if provided.
}
